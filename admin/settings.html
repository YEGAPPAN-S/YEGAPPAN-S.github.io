<!DOCTYPE html>
<html lang="en" data-theme="light">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Settings — Admin</title>
  <meta name="robots" content="noindex, nofollow">
  <link rel="stylesheet" href="/assets/css/styles.css">
  <link rel="stylesheet" href="/assets/css/admin.css">
  <link rel="icon" href="/images/favicon.ico">
</head>
<body class="admin-body">

<div class="admin-layout">
  <aside class="admin-sidebar" id="admin-sidebar">
    <a href="/admin/" class="admin-sidebar__logo">
      <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="3" width="7" height="7"/><rect x="14" y="3" width="7" height="7"/><rect x="14" y="14" width="7" height="7"/><rect x="3" y="14" width="7" height="7"/></svg>
      Yega<span>.</span> Admin
    </a>
    <nav class="admin-nav">
      <div class="admin-nav__section">Content</div>
      <a href="/admin/" class="admin-nav__item"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="3" width="7" height="7"/><rect x="14" y="3" width="7" height="7"/><rect x="14" y="14" width="7" height="7"/><rect x="3" y="14" width="7" height="7"/></svg>Dashboard</a>
      <a href="/admin/posts.html" class="admin-nav__item"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"/><path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"/></svg>Posts</a>
      <a href="/admin/editor.html" class="admin-nav__item"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/></svg>New Post</a>
      <div class="admin-nav__section">Site</div>
      <a href="/admin/settings.html" class="admin-nav__item active"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="3"/></svg>Settings</a>
      <a href="/" target="_blank" class="admin-nav__item"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"/><polyline points="15,3 21,3 21,9"/><line x1="10" y1="14" x2="21" y2="3"/></svg>View Site</a>
    </nav>
    <div class="admin-sidebar__footer">
      <button id="logout-btn" class="btn btn--ghost btn--sm" style="width:100%; color:var(--text-3);">
        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"/><polyline points="16,17 21,12 16,7"/><line x1="21" y1="12" x2="9" y2="12"/></svg>
        Logout
      </button>
    </div>
  </aside>

  <div class="admin-main">
    <div class="admin-topbar">
      <div style="display:flex; align-items:center; gap:1rem;">
        <button id="sidebar-toggle" class="btn btn--ghost btn--sm" style="padding:0.4rem;">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="3" y1="12" x2="21" y2="12"/><line x1="3" y1="6" x2="21" y2="6"/><line x1="3" y1="18" x2="21" y2="18"/></svg>
        </button>
        <span class="admin-topbar__title">Settings</span>
      </div>
      <div class="admin-topbar__actions">
        <button class="theme-toggle" aria-label="Toggle theme">
          <svg class="icon-sun" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/></svg>
          <svg class="icon-moon" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/></svg>
        </button>
        <button class="btn btn--primary btn--sm" id="save-settings-btn">Save Settings</button>
      </div>
    </div>

    <div class="admin-content" style="max-width:700px;">
      <div id="settings-msg" style="margin-bottom:1rem;"></div>

      <form id="settings-form">
        <div style="background:var(--bg); border:1px solid var(--border); border-radius:10px; overflow:hidden; margin-bottom:1.5rem;">
          <div style="padding:1rem 1.5rem; border-bottom:1px solid var(--border); background:var(--bg-alt);">
            <h3 style="font-size:0.8125rem; font-weight:700; text-transform:uppercase; letter-spacing:0.1em; color:var(--text-3); margin:0;">Site Identity</h3>
          </div>
          <div style="padding:1.5rem; display:grid; gap:1rem;">
            <div class="form-group" style="margin-bottom:0;">
              <label class="form-label">Site Name</label>
              <input class="form-input" type="text" name="site_name" placeholder="Yegappan Sekar">
            </div>
            <div class="form-group" style="margin-bottom:0;">
              <label class="form-label">Tagline</label>
              <input class="form-input" type="text" name="site_tagline" placeholder="Senior Software Engineer">
            </div>
            <div class="form-group" style="margin-bottom:0;">
              <label class="form-label">Site Description (SEO)</label>
              <textarea class="form-textarea" name="site_description" style="min-height:80px;" placeholder="Used in meta description"></textarea>
            </div>
            <div class="form-group" style="margin-bottom:0;">
              <label class="form-label">Site URL</label>
              <input class="form-input" type="url" name="site_url" placeholder="https://your-username.github.io">
            </div>
          </div>
        </div>

        <div style="background:var(--bg); border:1px solid var(--border); border-radius:10px; overflow:hidden; margin-bottom:1.5rem;">
          <div style="padding:1rem 1.5rem; border-bottom:1px solid var(--border); background:var(--bg-alt);">
            <h3 style="font-size:0.8125rem; font-weight:700; text-transform:uppercase; letter-spacing:0.1em; color:var(--text-3); margin:0;">Author</h3>
          </div>
          <div style="padding:1.5rem; display:grid; gap:1rem;">
            <div class="form-group" style="margin-bottom:0;">
              <label class="form-label">Author Name</label>
              <input class="form-input" type="text" name="author_name" placeholder="Yegappan Sekar">
            </div>
            <div class="form-group" style="margin-bottom:0;">
              <label class="form-label">Author Email</label>
              <input class="form-input" type="email" name="author_email" placeholder="you@example.com">
            </div>
            <div class="form-group" style="margin-bottom:0;">
              <label class="form-label">Author Bio</label>
              <textarea class="form-textarea" name="author_bio" style="min-height:80px;" placeholder="Short bio shown on the site"></textarea>
            </div>
          </div>
        </div>

        <div style="background:var(--bg); border:1px solid var(--border); border-radius:10px; overflow:hidden; margin-bottom:1.5rem;">
          <div style="padding:1rem 1.5rem; border-bottom:1px solid var(--border); background:var(--bg-alt);">
            <h3 style="font-size:0.8125rem; font-weight:700; text-transform:uppercase; letter-spacing:0.1em; color:var(--text-3); margin:0;">Social Links</h3>
          </div>
          <div style="padding:1.5rem; display:grid; gap:1rem;">
            <div class="form-group" style="margin-bottom:0;">
              <label class="form-label">GitHub URL</label>
              <input class="form-input" type="url" name="github_url" placeholder="https://github.com/username">
            </div>
            <div class="form-group" style="margin-bottom:0;">
              <label class="form-label">LinkedIn URL</label>
              <input class="form-input" type="url" name="linkedin_url" placeholder="https://linkedin.com/in/username">
            </div>
            <div class="form-group" style="margin-bottom:0;">
              <label class="form-label">Twitter URL (optional)</label>
              <input class="form-input" type="url" name="twitter_url" placeholder="https://twitter.com/username">
            </div>
          </div>
        </div>

        <div style="background:var(--bg); border:1px solid var(--border); border-radius:10px; overflow:hidden;">
          <div style="padding:1rem 1.5rem; border-bottom:1px solid var(--border); background:var(--bg-alt);">
            <h3 style="font-size:0.8125rem; font-weight:700; text-transform:uppercase; letter-spacing:0.1em; color:var(--text-3); margin:0;">Homepage Hero</h3>
          </div>
          <div style="padding:1.5rem; display:grid; gap:1rem;">
            <div class="form-group" style="margin-bottom:0;">
              <label class="form-label">Hero Title</label>
              <input class="form-input" type="text" name="hero_title" placeholder="Building Tools That Work While You Sleep">
            </div>
            <div class="form-group" style="margin-bottom:0;">
              <label class="form-label">Hero Subtitle</label>
              <textarea class="form-textarea" name="hero_subtitle" style="min-height:80px;" placeholder="Short tagline below the hero title"></textarea>
            </div>
          </div>
        </div>
      </form>
    </div>
  </div>
</div>

<script src="/assets/js/app.js"></script>
<script src="/assets/js/api.js"></script>
<script>
if (!API.Admin.requireAuth()) {}
document.getElementById('logout-btn').addEventListener('click', async () => { await API.Admin.logout(); window.location.href = '/admin/login.html'; });
document.getElementById('sidebar-toggle').addEventListener('click', () => { document.getElementById('admin-sidebar').classList.toggle('open'); });

async function loadSettings() {
  try {
    const res = await API.Admin.getSettings();
    const settings = res.data || {};
    const form = document.getElementById('settings-form');
    Object.entries(settings).forEach(([key, val]) => {
      const el = form.querySelector(`[name="${key}"]`);
      if (el) el.value = val || '';
    });
  } catch(e) {
    document.getElementById('settings-msg').innerHTML = `<div class="alert alert--error">Failed to load settings: ${e.message}</div>`;
  }
}

document.getElementById('save-settings-btn').addEventListener('click', async () => {
  const form = document.getElementById('settings-form');
  const inputs = form.querySelectorAll('[name]');
  const data = {};
  inputs.forEach(el => { if (el.name) data[el.name] = el.value; });

  document.getElementById('save-settings-btn').disabled = true;
  const msgEl = document.getElementById('settings-msg');

  try {
    await API.Admin.updateSettings(data);
    msgEl.innerHTML = '<div class="alert alert--success">✓ Settings saved successfully!</div>';
    setTimeout(() => msgEl.innerHTML = '', 4000);
  } catch(e) {
    msgEl.innerHTML = `<div class="alert alert--error">${e.message || 'Failed to save settings'}</div>`;
  } finally {
    document.getElementById('save-settings-btn').disabled = false;
  }
});

loadSettings();
</script>
</body>
</html>
